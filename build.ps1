# –°–∫—Ä–∏–ø—Ç –¥–ª—è —Å–±# --console: –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–æ–Ω—Å–æ–ª—å–Ω–æ–µ –æ–∫–Ω–æ. –≠—Ç–æ –Ω—É–∂–Ω–æ, —á—Ç–æ–±—ã CLI-—Ä–µ–∂–∏–º –º–æ–≥ –≤—ã–≤–æ–¥–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é.
#   –ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ –±–µ–∑ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ GUI –≤—Å–µ —Ä–∞–≤–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è, –Ω–æ —Å –∫–æ–Ω—Å–æ–ª—å—é –Ω–∞ —Ñ–æ–Ω–µ.
#   –≠—Ç–æ –∫–æ–º–ø—Ä–æ–º–∏—Å—Å –¥–ª—è –≥–∏–±—Ä–∏–¥–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.
$pyinstallerCommand = "pyinstaller --onefile --console --name $AppName"

# –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
$AppName = "RepoCopier"
$MainScript = "main.py"
$Icon = "icon.ico" # –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É –∏–∫–æ–Ω–∫–∏ .ico

# --- –ü—Ä–æ–≤–µ—Ä–∫–∏ ---
if (-not (Test-Path $MainScript)) {
    Write-Host "‚ùå –ì–ª–∞–≤–Ω—ã–π —Å–∫—Ä–∏–ø—Ç '$MainScript' –Ω–µ –Ω–∞–π–¥–µ–Ω. –°–±–æ—Ä–∫–∞ –æ—Ç–º–µ–Ω–µ–Ω–∞." -ForegroundColor Red
    exit 1
}

# --- –ö–æ–º–∞–Ω–¥–∞ PyInstaller ---
# --onefile: –°–æ–±—Ä–∞—Ç—å –≤—Å—ë –≤ –æ–¥–∏–Ω –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π —Ñ–∞–π–ª.
# --windowed: –ù–µ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –∫–æ–Ω—Å–æ–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ GUI.
# --name: –ò–º—è –≤—ã—Ö–æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞.
# --icon: –ü—É—Ç—å –∫ –∏–∫–æ–Ω–∫–µ.
# --add-data: –í–∫–ª—é—á–µ–Ω–∏–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –∏–ª–∏ –ø–∞–ø–æ–∫.
#   –§–æ—Ä–º–∞—Ç "–ø—É—Ç—å_–≤_–∏—Å—Ö–æ–¥–Ω–∏–∫–∞—Ö;–ø—É—Ç—å_–≤_—Å–±–æ—Ä–∫–µ".
#   –¢–æ—á–∫–∞ '.' –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ —Ñ–∞–π–ª –±—É–¥–µ—Ç –≤ –∫–æ—Ä–Ω–µ —Å–±–æ—Ä–∫–∏.
#   –í –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –º—ã –Ω–µ –¥–æ–±–∞–≤–ª—è–µ–º –¥–æ–ø. —Ñ–∞–π–ª—ã, –Ω–æ —ç—Ç–æ –ø–æ–ª–µ–∑–Ω–æ –∑–Ω–∞—Ç—å.

$pyinstallerCommand = "pyinstaller --onefile --windowed --name $AppName"

if (Test-Path $Icon) {
    $pyinstallerCommand += " --icon=$Icon"
} else {
    Write-Host "‚ö†Ô∏è  –§–∞–π–ª –∏–∫–æ–Ω–∫–∏ '$Icon' –Ω–µ –Ω–∞–π–¥–µ–Ω, —Å–±–æ—Ä–∫–∞ –±—É–¥–µ—Ç –±–µ–∑ –∏–∫–æ–Ω–∫–∏." -ForegroundColor Yellow
}

# –î–æ–±–∞–≤–ª—è–µ–º –≥–ª–∞–≤–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –≤ –∫–æ–º–∞–Ω–¥—É
$pyinstallerCommand += " $MainScript"

# --- –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ ---
Write-Host "üöÄ –ó–∞–ø—É—Å–∫–∞—é —Å–±–æ—Ä–∫—É '$AppName'..." -ForegroundColor Green
Write-Host "–ö–æ–º–∞–Ω–¥–∞: $pyinstallerCommand"

try {
    Invoke-Expression $pyinstallerCommand
    Write-Host "‚úÖ –°–±–æ—Ä–∫–∞ —É—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!" -ForegroundColor Green
    Write-Host "–ò—Å–ø–æ–ª–Ω—è–µ–º—ã–π —Ñ–∞–π–ª –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –ø–∞–ø–∫–µ 'dist'."
} catch {
    Write-Host "‚ùå –û—à–∏–±–∫–∞ –≤–æ –≤—Ä–µ–º—è —Å–±–æ—Ä–∫–∏:" -ForegroundColor Red
    Write-Host $_.Exception.Message -ForegroundColor Red
    exit 1
}

# --- –û—á–∏—Å—Ç–∫–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) ---
# –í—ã –º–æ–∂–µ—Ç–µ —Ä–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å —ç—Ç–∏ —Å—Ç—Ä–æ–∫–∏, —á—Ç–æ–±—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è—Ç—å
# –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –∏ –ø–∞–ø–∫–∏ –ø–æ—Å–ª–µ —Å–±–æ—Ä–∫–∏.

# Write-Host "üßπ –û—á–∏—Å—Ç–∫–∞ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤..."
# if (Test-Path "$AppName.spec") { Remove-Item "$AppName.spec" }
# if (Test-Path "build") { Remove-Item -Recurse -Force "build" }

Write-Host "üéâ –ì–æ—Ç–æ–≤–æ!"
